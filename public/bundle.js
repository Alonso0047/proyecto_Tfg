'use strict';

var data$1 = {
    
        frenos:[
            {
                id:1,
                imagen:'./imagenes/frenos/1.png',
                precio: 83.60,
                nombre: 'BREMBO P 50 067X Juego de pastillas de freno',
            },

            {
                id:2,
                imagen:'./imagenes/frenos/2.png',
                precio: 37.52,
                nombre: 'BREMBO P 50 067 Juego de pastillas de freno',
            },

            {
                id:3,
                imagen:'./imagenes/frenos/3.png',
                precio: 16.25,
                nombre: 'BOSCH 0 986 424 098 Juego de pastillas de freno',
            },

            {
                id:4,
                imagen:'./imagenes/frenos/4.png',
                precio: 29.93,
                nombre: 'BREMBO P 50 045 Juego de pastillas de freno',
            },

            {
                id:5,
                imagen:'./imagenes/frenos/5.png',
                precio: 18.00,
                nombre: 'BOSCH 0 986 424 512 Juego de pastillas de freno',
            },

            {
                id:6,
                imagen:'./imagenes/frenos/6.png',
                precio: 61.20,
                nombre: 'TRW DTEC COTEC GDB1736DTE Juego de pastillas de freno',
            },

            {
                id:7,
                imagen:'./imagenes/frenos/7.png',
                precio: 34.40,
                nombre: 'BREMBO P 28 023 Juego de pastillas de freno',
            },

            {
                id:8,
                imagen:'./imagenes/frenos/8.png',
                precio: 87.50,
                nombre: 'BREMBO P 85 069 Juego de pastillas de freno',
            },

            {
                id:9,
                imagen:'./imagenes/frenos/9.png',
                precio: 25.20,
                nombre: 'RIDEX 402B0257 Juego de pastillas de freno',
            },

            {
                id:10,
                imagen:'./imagenes/frenos/10.png',
                precio: 52.65,
                nombre: 'TRW DTEC COTEC GDB1550DTE Juego de pastillas de freno',
            },

            {
                id:11,
                imagen:'./imagenes/frenos/10.png',
                precio: 38.97,
                nombre: 'MASTER-SPORT 13046072272-SET-MS Juego de pastillas de freno',
            },
        ],

         aceitesYFiltros: [
            {
                id:12,
                imagen:'./imagenes/aceitesYfiltros/12.png',
                precio: 48.45,
                nombre: 'Castrol EDGE 5W-30 LL Aceite de Motor 5L',
            },

            {
                id:13,
                imagen:'./imagenes/aceitesYfiltros/13.png',
                precio: 35.32,
                nombre: 'MOTUL Aceite de Motor 8100 X-Cess, 5W40-5 L',
            },

            {
                id:14,
                imagen:'./imagenes/aceitesYfiltros/14.png',
                precio: 32.20,
                nombre: 'REPSOL aceite lubricante sintético para coche ELITE 50501 5W-40 5L',
            },

            {
                id:15,
                imagen:'./imagenes/aceitesYfiltros/15.png',
                precio: 37.80,
                nombre: 'Castrol , Aceite DE Motor Power1 4T 10w40 4 Litros Hombres, Transparente, L',
            },

            {
                id:16,
                imagen:'./imagenes/aceitesYfiltros/16.png',
                precio: 35.70,
                nombre: 'Total Aceite Lubricante de Motor Total Quartz Ineo ECS 5W-30 5 Litros',
            },

            {
                id:17,
                imagen:'./imagenes/aceitesYfiltros/17.png',
                precio: 14.32,
                nombre: 'K&N Filters HP-2011 Filtro de aceite',
            },

            {
                id:18,
                imagen:'./imagenes/aceitesYfiltros/18.png',
                precio: 9.25,
                nombre: 'MANN-FILTER W 610/4 Filtro de aceite',
            },

            {
                id:19,
                imagen:'./imagenes/aceitesYfiltros/19.png',
                precio: 12.00,
                nombre: 'BOSCH F 026 407 233 Filtro de aceite',
            },

            {
                id:20,
                imagen:'./imagenes/aceitesYfiltros/20.png',
                precio: 9.12,
                nombre: 'BOSCH F 026 407 015 Filtro de aceite',
            },

            {
                id:21,
                imagen:'./imagenes/aceitesYfiltros/21.png',
                precio: 8.75,
                nombre: 'BOSCH 0 451 103 261 Filtro de aceite',
            },

            {
                id:22,
                imagen:'./imagenes/aceitesYfiltros/22.png',
                precio: 12.45,
                nombre: 'BOSCH 0 451 103 369 Filtro de aceite',
            },

        ],

        ruedas:[

            {
                id:23,
                imagen:'./imagenes/ruedas/23.png',
                precio: 105.00,
                nombre: 'Neumático MICHELIN PILOT SPORT 4 225/45 R17 94 Y XL',
            },

            {
                id:24,
                imagen:'./imagenes/ruedas/24.png',
                precio: 105.00,
                nombre: 'Neumático PIRELLI P ZERO 225/40 R18 92 Y KS XL',
            },

            {
                id:25,
                imagen:'./imagenes/ruedas/25.png',
                precio: 83.25,
                nombre: 'Neumático MICHELIN PRIMACY 4 195/65 R15 91 V',
            },

            {
                id:26,
                imagen:'./imagenes/ruedas/26.png',
                precio: 158.50,
                nombre: 'Neumático MICHELIN PILOT SPORT CUP 2 CONNECT 225/40 R18 92 Y XL',
            },

            {
                id:27,
                imagen:'./imagenes/ruedas/27.png',
                precio: 78.00,
                nombre: 'Neumático NANKANG SPORTNEX NS-2R 195/50R15 86W XL',
            },

            {
                id:28,
                imagen:'./imagenes/ruedas/28.png',
                precio: 150.00,
                nombre: 'Michelin Pilot Sport Cup 2 225/40 R18 92Y XL neumáticos de verano',
            },

            {
                id:29,
                imagen:'./imagenes/ruedas/29.png',
                precio: 95.50,
                nombre: 'Neumático GOODYEAR EAGLE F1 ASYMMETRIC 6 225/40 R18 92 Y XL',
            },

            {
                id:30,
                imagen:'./imagenes/ruedas/30.png',
                precio: 499.99,
                nombre: 'Neumático MICHELIN PILOT SPORT 4 S 235/40 R21 105 Y',
            },

            {
                id:31,
                imagen:'./imagenes/ruedas/31.png',
                precio: 82.93,
                nombre: 'NANKANG 195/55ZR15 89W XL NS-2R',
            },

            {
                id:32,
                imagen:'./imagenes/ruedas/32.png',
                precio: 89.12,
                nombre: 'TOYO 225/40ZR18 92Y XL PROXES R888R',
            },

            {
                id:33,
                imagen:'./imagenes/ruedas/33.png',
                precio: 73.50,
                nombre: 'Neumático GOODYEAR EFFICIENTGRIP PERFORMANCE 2 195/65 R15 91 H',
            },

        ],

        bombillasYreles: [

            {
                id:34,
                imagen:'./imagenes/bombillasYreles/34.png',
                precio: 34.80,
                nombre: 'PHILIPS - 2 ✕ H7 RacingVision GT200 - 12972RGTS2',
            },

            {
                id:35,
                imagen:'./imagenes/bombillasYreles/35.png',
                precio: 26.30,
                nombre: 'Philips X-tremeVision Pro150 H7 bombilla faros delanteros +150%, Halógena, paquete doble',
            },

            {
                id:36,
                imagen:'./imagenes/bombillasYreles/36.png',
                precio: 84.82,
                nombre: 'Philips automotive lighting Ultinon Pro6000 Boost H7 LED Boost lámpara LED homologada, juego de 2',
            },

            {
                id:37,
                imagen:'./imagenes/bombillasYreles/37.png',
                precio: 20.92,
                nombre: 'Philips RacingVision GT200 H4 bombilla para faros delanteros +200%, set de2',
            },

            {
                id:38,
                imagen:'./imagenes/bombillasYreles/38.jpg',
                precio: 34.65,
                nombre: 'KOYOSO H11 LED Bombilla 19000LM 110W para 12V Automóvil',
            },

            {
                id:39,
                imagen:'./imagenes/bombillasYreles/39.jpg',
                precio: 42.68,
                nombre: 'KOYOSO Bombillas 9006/HB4 LED Coche, LED Faro Lámpara 16000LM Compatible con DC 12V para Eficiencia Energética',
            },

            {
                id:40,
                imagen:'./imagenes/bombillasYreles/40.png',
                precio: 20.32,
                nombre: 'JOREST 300Pcs 12v Fusibles Coche Kit, 160 Mini Fusible Coche, 90 Mediano Fusible Coche, 50 Micro Fusible, Turismos',
            },

            {
                id:41,
                imagen:'./imagenes/bombillasYreles/41.png',
                precio: 60.72,
                nombre: 'BOSCH 1 987 529 079 Surtido, fusibles',
            },

            {
                id:42,
                imagen:'./imagenes/bombillasYreles/42.png',
                precio: 21.92,
                nombre: '20 piezas para coche y camión, relé automotriz DC 12V, 20A/30A, SPDT, 5 pines, 5 P + 4 pines, 4 P',
            },

            {
                id:43,
                imagen:'./imagenes/bombillasYreles/43.png',
                precio: 31.29,
                nombre: 'Gebildet Caja Relé y Fusible 12 V con 5pcs Relés 5 Pines JD1914 40 A',
            },

            {
                id:44,
                imagen:'./imagenes/bombillasYreles/44.png',
                precio: 16.82,
                nombre: 'AUKENIEN Micro Fusibles Coche Kit 2A 3A 5A 7,5A 10A 15A 20A 25A 30A 35A 40A Fusibles 12V Fusible Coche',
            },

        ], 
    
};

const contenedorPrincipal$1 = document.getElementById('contenedor__principal');

// Función para cargar la categoría especificada
const cargarCategoria = (categoria) => {
    // Limpia el contenedor principal
    contenedorPrincipal$1.innerHTML = '';

    // Filtra los datos según la categoría seleccionada
    const categoriaDatos = data$1[categoria];

    // Itera a través de los datos y crea elementos
    categoriaDatos.forEach((item) => {
        const nuevoElemento = document.createElement('a');
        const plantilla = `
            <div class="contenedor-secundario">
                <img class="imagen" src="${item.imagen}" alt="${item.nombre}">
                <h3 class="precio">$${item.precio.toFixed(2)}</h3>
                <p class="descripcion">${item.nombre}</p>
            </div>
        `;

        nuevoElemento.innerHTML = plantilla;
        nuevoElemento.classList.add('editar-a');
        nuevoElemento.dataset.categoria = item.id;
        nuevoElemento.href = '#'; // Enlace según sea necesario
        
        // Añade el nuevo elemento al contenedor principal
        contenedorPrincipal$1.appendChild(nuevoElemento);
    });
};

// Obtiene el parámetro de consulta 'categoria' de la URL
const urlParams = new URLSearchParams(window.location.search);
const categoria = urlParams.get('categoria');

// Si hay un parámetro de consulta 'categoria', carga la categoría correspondiente
if (categoria) {
    cargarCategoria(categoria);
}

const contenedorPrincipal=document.getElementById('contenedor__principal');
const producto$2 = document.getElementById('producto');
const informacion = document.getElementById('mas-informacion');


contenedorPrincipal.addEventListener('click', (e)=>{
    e.preventDefault();
    if(e.target.closest('a')){
        contenedorPrincipal.classList.add('hidden');
        producto$2.classList.add('active');
        informacion.classList.remove('mas-informacion');

        

       
        
    }

});

const producto$1 = document.getElementById('producto');
const productoImagen= producto$1.querySelector('.producto__imagen');
const thumbs = producto$1.querySelector('.producto__thumbs');

//Color
const propiedadColor= producto$1.querySelector('#propiedad-color');

//Cantidad

const btnDisminuirCantidad = producto$1.querySelector('#disminuir-cantidad');
const btnIncrementarCantidad = producto$1.querySelector('#incrementar-cantidad');
const inputCantidad = producto$1.querySelector('#cantidad');

//Funcionalidad thums
thumbs.addEventListener('click',(e)=>{
    if(e.target.tagName==='IMG'){
        //Para obtener una imagen del html y la carpeta y colocarla donde indiquemos
        const imagenSRC = e.target.src;
        const lastIndex = imagenSRC.lastIndexOf('/');
        //Cortamos la cadena de texto para obtener solamente una parte
        const nombreImagen = imagenSRC.substring(lastIndex+1);
        productoImagen.src=`./img/tennis/${nombreImagen}`;
    }
});

//Funcionalidad de color
propiedadColor.addEventListener('click', (e)=>{


    /* Estamso trabajando con el valor de value
    Que tiene que coincidir con el nombre de la imagen
    <label for="negro">
		<input
		type="radio"
		class="producto__radio-input"
		name="color"
		id="negro"
	    value="negro"
		checked
		/> */


    if(e.target.tagName==='INPUT'){
        productoImagen.src = `./img/tennis/${e.target.value}.jpg`;

    }
});


btnIncrementarCantidad.addEventListener('click', (e)=>{
    inputCantidad.value=parseInt(inputCantidad.value)+1;
});

btnDisminuirCantidad.addEventListener('click', (e)=>{
    if(parseInt(inputCantidad.value)>1){
        inputCantidad.value=parseInt(inputCantidad.value)-1;
    }
    
});

var data = {
    productos:[
        {
            id: '1',
            nombre: 'Tennis Converse Standard',
            descripcion: 'Zapatillas para todo tipo de sexo y edad',
            precio: 500.0,
            colores: ['negro','rojo', 'amarillo'],
            tamaños: ['1,5', '2','2,5','3','3,5','4'],   

        },

        {
            id: '2',
            nombre: 'Tennis Converse 2000',
            descripcion: 'Zapatillas de calidad y a buen precio',
            precio: 450.0,
            colores: ['negro','rojo', 'amarillo'],
            tamaños: ['1,5', '2','2,5','3','3,5','4'],   

        }
    ]
};

const botonesAbrirCarrito = document.querySelectorAll('[data-accion="abrir-carrito"]');
const botonesCerrarCarrito = document.querySelectorAll('[data-accion="cerrar-carrito"]');
const ventanaCarrito = document.getElementById('carrito');
const btnAgregarAlCarrito = document.getElementById('agregar-al-carrito');
const producto = document.getElementById('producto');
let carrito = [];
const notificacion = document.getElementById('notificacion');

const formatearMoneda = new Intl.NumberFormat('es-ES', {style: 'currency', currency: 'EUR'});



const renderCarrito = ()=>{
    ventanaCarrito.classList.add('carrito--active');

    //Eliminamos todos los productos anteriores para construir el carrito desde 0
    const productosAnteriores = ventanaCarrito.querySelectorAll('.carrito__producto');
    productosAnteriores.forEach((producto) => producto.remove());

    let total = 0;



    //Comprobamos si hay productos
    if(carrito.length < 1){
        ventanaCarrito.classList.add('carrito--vacio');
    }else {
        //Eliminamos la clase del carrito vacio
        ventanaCarrito.classList.remove('carrito--vacio');
        carrito.forEach((productoCarrito)=>{

            //Igualamos el id de el producto de la base de datos y del que tenemos en el html que son los dos 1 para acceder al precio
            data.productos.forEach((productoBaseDatos)=>{
                if (productoBaseDatos.id===productoCarrito.id){
                    productoCarrito.precio=productoBaseDatos.precio;


                   total += productoBaseDatos.precio * productoCarrito.cantidad;

                }
    
            });


    
            
    
            //Establecemos la ruta de la imagen que vamos a querer mostrar
            let thumbSrc = producto.querySelectorAll('.producto__thumb-img')[0].src;
            if(productoCarrito.color==='rojo'){
                thumbSrc = './img/thumbs/rojo.jpg';
            }else if(productoCarrito.color==='amarillo'){
                thumbSrc = './img/thumbs/amarillo.jpg';
            }
    
    
            //Creamos una plantilla del codigo html
            const plantillaProducto=`
            <div class="carrito__producto-info">
                    <img src="${thumbSrc}" alt="" class="carrito__thumb" />
                        <div>
                            <p class="carrito__producto-nombre">
                                <span class="carrito__producto-cantidad">${productoCarrito.cantidad} x </span>${productoCarrito.nombre}
                            </p>
                            <p class="carrito__producto-propiedades">
                            Tamaño:<span>${productoCarrito.tamaño}</span> Color:<span>${productoCarrito.color}</span>
                            </p>
                        </div>
             </div>
            <div class="carrito__producto-contenedor-precio">
                    <button class="carrito__btn-eliminar-item" data-accion="eliminar-item-carrito">
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg"
                                            width="16"
                                            height="16"
                                            fill="currentColor"
                                            viewBox="0 0 16 16"
                                        >
                                            <path
                                                d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"
                                            />
                                        </svg>
                                    </button>
                                    <p class="carrito__producto-precio">${formatearMoneda.format(productoCarrito.precio*productoCarrito.cantidad)}</p>
                                </div>
            `;
            //Creamos un div
            const itemCarrito = document.createElement('div');
            //Le agregamos la clase carrito producto 
            itemCarrito.classList.add('carrito__producto');
            //Insertamos la plantilla
            itemCarrito.innerHTML =  plantillaProducto;
            //Agregamos el producto a la ventana producto 
            ventanaCarrito.querySelector('.carrito__body').appendChild(itemCarrito);
    
        });
    }

    ventanaCarrito.querySelector('.carrito__total').innerText= formatearMoneda.format(total);
    
   

};

botonesAbrirCarrito.forEach((boton)=>{
    boton.addEventListener('click',()=>{
        renderCarrito();
    });
});

botonesCerrarCarrito.forEach((boton)=>{
    boton.addEventListener('click',()=>{
        ventanaCarrito.classList.remove('carrito--active');
    });
});

btnAgregarAlCarrito.addEventListener('click',(e)=>{
    const id = producto.dataset.productoId;
	const nombre = producto.querySelector('.producto__nombre').innerText;
	const cantidad = parseInt(producto.querySelector('#cantidad').value);
	const color = producto.querySelector('#propiedad-color input:checked').value;
	const tamaño = producto.querySelector('#propiedad-tamaño input:checked').value;

    if (carrito.length>0){
        let productoEnCarrito = false;
        carrito.forEach((item)=>{
            if (item.id===id && item.nombre===nombre && item.color===color && item.tamaño===tamaño){
                item.cantidad += cantidad;
                productoEnCarrito=true;
            }
                
            
        });

        if(!productoEnCarrito){
            carrito.push({
                id: id,
                cantidad: cantidad,
                color: color,
                nombre: nombre,
                tamaño: tamaño
            });
        }
    }else {
        carrito.push({
        id: id,
        cantidad: cantidad,
        color: color,
        nombre: nombre,
        tamaño: tamaño
    });
 }

    //Establecemos la ruta de la imagen que vamos a querer mostrar

    let thumbsSrc = producto.querySelectorAll('.producto__thumb-img')[0].src;
    if(color==='rojo'){
        thumbsSrc = './img/thumbs/rojo.jpg';
    } else if(color==='amarillo'){
        thumbsSrc = './img/thumbs/amarillo.jpg';
    }

    notificacion.querySelector('img').src=thumbsSrc;
    //Mostramos la notificacion
    notificacion.classList.add('notificacion--active');
    //Despues de 5 segundos la ocultamos

    setTimeout(()=>{
        notificacion.classList.remove('notificacion--active');
    },5000);

    
});
//Botones eliminar carrito
ventanaCarrito.addEventListener('click', (e)=>{
    if(e.target.closest('button')?.dataset.accion==='eliminar-item-carrito'){
        const producto = e.target.closest('.carrito__producto');
        const indexProducto = [...ventanaCarrito.querySelectorAll('.carrito__producto')].indexOf(producto);
        carrito = carrito.filter((item, index)=>{
            if(index !== indexProducto){
                return item;
            }
        });
        renderCarrito();
    }
});

ventanaCarrito.querySelector('#carrito__btn-comprar').addEventListener('click', ()=>{
    
});
